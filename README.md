# Vectorial Martingale Optimal Transport (VMOT)

This repository contains the numerical implementation for the research paper **"Geometry of vectorial martingale optimal transport and robust option pricing"** by Hiew, Lim, Pass, and Souza (2023). The project focuses on solving the **Vectorial Martingale Optimal Transport (VMOT)** problem with applications in robust finance, particularly in robust option pricing.

## Abstract
This paper addresses robust finance, which focuses on developing models that account for model mis-specifications. Specifically, we investigate the **Vectorial Martingale Optimal Transport (VMOT)** problem, the geometry of its solutions, and its application to robust option pricing. To this end, we consider *\( N \)-period market models* with \( N \geq 2 \) and show that when the number of underlying assets (spatial dimension) is \( d = 2 \), the extremal model for cap options with sub- or supermodular payoffs reduces to a single-factor structure in the first period. However, this reduction does not hold in general when \( d \geq 3 \). Our results reveal a subtle relationship between the spatial dimension, cost function supermodularity, and the geometry of VMOT solutions. We also demonstrate how the monotonicity structure in VMOT leads to computational improvements in solving the problem.

## Features
- **Dual Problem Computation**: Implements the dual formulation of the VMOT problem using the framework established by Eckstein and Kupper (2021).
- **Dimensional Reduction**: Exploits a dimensional reduction technique in some cases, enabled by a monotonicity property, as described in the research paper.
- **Neural Network Optimization**: Uses **Adam gradient descent optimizer** through Python's PyTorch library  for neural network implementation.
- **Numerical Experiments**: Provides scripts for reproducing results from the paper, including robust option pricing problems in two-period market models.

---

## Installation
To set up the project environment, use the provided `requirements.txt` file to install necessary dependencies:
```bash
pip install -r requirements.txt
```

Make sure you have Python 3.8 or later installed.

---

## Project Structure

```
vmot/
├── graphics/               # Output plots and graphics generated by the project
├── results/                # Numerical results from simulations
├── src/                    # Source code for numerical computations
│   ├── vmot_dual.py        # Core implementation of the VMOT dual problem
│   ├── uniform_marginals_T2.py  # Example file for T=2
│   ├── uniform_marginals_T3.py  # Example file for T=3
│   ├── plots.py            # Visualization and plotting utilities
├── tests/                  # Unit tests for the project
├── requirements.txt        # List of dependencies
├── README.md               # Project documentation (this file)
```

---

## Usage
1. Clone the repository:
   ```bash
   git clone https://github.com/your_username/vmot.git
   cd vmot
   ```

2. Run the example scripts to reproduce results:
   ```bash
   python src/uniform_marginals_T2.py
   python src/uniform_marginals_T3.py
   ```

3. Generate plots and visualizations:
   ```bash
   python src/plots.py
   ```

---

## References
1. Hiew, Lim, Pass, and Souza (2023). [Geometry of vectorial martingale optimal transport and robust option pricing](https://arxiv.org/abs/2309.04947).
2. Eckstein, Guo, Lim, and Obloj (2021). "Robust Pricing and Hedging of Options on Multiple Assets and Its Numerics."
3. Eckstein and Kupper (2021). "Computation of Optimal Transport and Related Hedging Problems via Penalization and Neural Networks."

---

## Citation
If you use this code in your research, please cite:
```bibtex
@article{hiewetal2023vmot,
  title={Geometry of vectorial martingale optimal transport and robust option pricing},
  author={Hiew, Joshua Zoen-Git and Lim, Tongseok and Pass, Brendan and de Souza, Marcelo Cruz},
  journal={arXiv preprint arXiv:2309.04947},
  year={2025}
}
```

---

## Contact
For questions or issues, please email `marcelo.souza@bcb,gov.br`.

---

## License
This project is licensed under the [MIT License](./LICENSE). You are free to use, modify, and distribute this project, provided that proper attribution is given to the authors.

For more details, see the [LICENSE](./LICENSE) file.
